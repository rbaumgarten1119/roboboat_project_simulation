<sdf version='1.10'>
  <world name='empty'>
    <physics name='1ms' type='ignored'>
      <max_step_size>0.001</max_step_size>
      <real_time_factor>1</real_time_factor>
      <real_time_update_rate>1000</real_time_update_rate>
    </physics>

    <!-- Core plugins -->
    <plugin name='gz::sim::systems::Physics' filename='gz-sim-physics-system'/>
    <plugin name='gz::sim::systems::UserCommands' filename='gz-sim-user-commands-system'/>
    <plugin name='gz::sim::systems::SceneBroadcaster' filename='gz-sim-scene-broadcaster-system'/>
    <plugin name='gz::sim::systems::Contact' filename='gz-sim-contact-system'/>
	<!-- world-level buoyancy system (must be child of <world>) -->
	<plugin filename="gz-sim-buoyancy-system" name="gz::sim::systems::Buoyancy">
	  <!-- graded buoyancy: water below z=0, air above -->
	  <graded_buoyancy>
	    <default_density>1000</default_density> <!-- water -->
	    <density_change>
	      <above_depth>0</above_depth>
	      <density>1</density> <!-- air -->
	    </density_change>
	  </graded_buoyancy>
	</plugin>
    <plugin
      filename="gz-sim-sensors-system"
      name="gz::sim::systems::Sensors">
      <render_engine>ogre2</render_engine>
    </plugin>
    <plugin filename="gz-sim-imu-system"
        name="gz::sim::systems::Imu">
    </plugin>
    

    <gravity>0 0 -9.8</gravity>
    <atmosphere type='adiabatic'/>

    <scene>
      <ambient>0.4 0.4 0.4 1</ambient>
      <background>0.7 0.7 0.7 1</background>
      <shadows>true</shadows>
    </scene>

    <!-- Roboboat -->
    <model name="roboboat">
      <pose>0 0 0.15 0 0 0</pose>
      <link name="hull">
        <inertial>
          <mass>25</mass>
          <inertia>
            <ixx>20</ixx>
            <iyy>20</iyy>
            <izz>40</izz>
          </inertia>
        </inertial>
        <collision name="hull_collision">
          <geometry>
            <box>
              <size>1.6 0.5588 0.05</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_visual">
          <geometry>
            <box>
              <size>1.6 0.5588 0.05</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>


        <collision name="hull_deck">
            <pose>0 0 0.354 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.5588 0.05</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_deck_visual">
          <pose>0 0 0.354 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.5588 0.05</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>
        
        <collision name="hull_front">
            <pose>-0.775 0 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>0.05 0.5588 0.354</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_front_visual">
          <pose>-0.775 0 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>0.05 0.5588 0.354</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>
        
        <collision name="hull_back">
            <pose>0.775 0 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>0.05 0.5588 0.354</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_back_visual">
          <pose>0.775 0 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>0.05 0.5588 0.354</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>
        
        <collision name="hull_side1">
            <pose>0 -0.2544 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.05 0.354</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_side1_visual">
          <pose>0 -0.2544 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.05 0.354</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>
        
        <collision name="hull_side2">
            <pose>0 0.2544 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.05 0.354</size>
            </box>
          </geometry>
        </collision>
        <visual name="hull_side2_visual">
          <pose>0 0.2544 0.179 0 0 0</pose>
          <geometry>
            <box>
              <size>1.6 0.05 0.354</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 0.8 1</ambient>
            <diffuse>0 0 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
          </material>
        </visual>
      </link>
      <link name='lidar_link'>
      	<pose>0.1 0 0.504 0 0 0</pose>
        <inertial>
          <mass>5</mass>
          <inertia>
            <ixx>1</ixx>
            <iyy>1</iyy>
            <izz>1</izz>
          </inertia>
        </inertial>
        <collision name='lidar_collision'>
          <geometry>
            <cylinder>
              <radius>0.1</radius>
              <length>0.2</length>
            </cylinder>
          </geometry>
        </collision>
        <visual name='lidar_visual'>
          <geometry>
            <cylinder>
              <radius>0.1</radius>
              <length>0.2</length>
            </cylinder>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>0 1 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
        <sensor name='gpu_lidar' type='gpu_lidar'>"
	    <pose>0 0 0 0 0 0</pose>
	    <topic>/lidar</topic>
	    <update_rate>10</update_rate>
	    <lidar>
		<scan>
		    <horizontal>
		        <samples>450</samples>
		        <resolution>1</resolution>
		        <min_angle>-3.141952</min_angle>
		        <max_angle>3.141952</max_angle>
		    </horizontal>
		    <vertical>
		        <samples>32</samples>
		        <resolution>1</resolution>
		        <min_angle>-0.0927</min_angle>
		        <max_angle>0.3927</max_angle>
		    </vertical>
		</scan>
		<range>
		    <min>0.08</min>
		    <max>10.0</max>
		    <resolution>0.01</resolution>
		</range>
	    </lidar>
	    <always_on>1</always_on>
	    <visualize>true</visualize>
			</sensor>	
			  </link>
		<link name ='imu_link'>
			<pose>-0.1 0 0.3 0 0 0</pose>
			<inertial>
			  <mass>5</mass>
			  <inertia>
				<ixx>1</ixx>
				<iyy>1</iyy>
				<izz>1</izz>
			  </inertia>
			</inertial>
			<collision name='imu_collision'>
			  <geometry>
				<cylinder>
				  <radius>0.1</radius>
				  <length>0.2</length>
				</cylinder>
			  </geometry>
			</collision>
			<visual name='imu_visual'>
			  <geometry>
				<cylinder>
				  <radius>0.1</radius>
				  <length>0.2</length>
				</cylinder>
			  </geometry>
			  <material>
				<ambient>0.3 0.3 0.3 1</ambient>
				<diffuse>0 1 1 1</diffuse>
				<specular>1 1 1 1</specular>
			  </material>
			</visual>
		  <sensor name="imu_sensor" type="imu">
		  	<pose>0 0 0 0 0 0</pose>
		  	<topic>/imu</topic>
			<always_on>1</always_on>
			<update_rate>50</update_rate>
			<imu>
			  <enable_orientation>0</enable_orientation>
			  <angular_velocity>
			    <x>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.009</stddev>
				<bias_mean>0.00075</bias_mean>
				<bias_stddev>0.005</bias_stddev>
				<dynamic_bias_stddev>0.00002</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>400.0</dynamic_bias_correlation_time>
				<precision>0.00025</precision>
			      </noise>
			    </x>
			    <y>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.009</stddev>
				<bias_mean>0.00075</bias_mean>
				<bias_stddev>0.005</bias_stddev>
				<dynamic_bias_stddev>0.00002</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>400.0</dynamic_bias_correlation_time>
				<precision>0.00025</precision>
			      </noise>
			    </y>
			    <z>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.009</stddev>
				<bias_mean>0.00075</bias_mean>
				<bias_stddev>0.005</bias_stddev>
				<dynamic_bias_stddev>0.00002</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>400.0</dynamic_bias_correlation_time>
				<precision>0.00025</precision>
			      </noise>
			    </z>
			  </angular_velocity>
			  <linear_acceleration>
			    <x>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.021</stddev>
				<bias_mean>0.05</bias_mean>
				<bias_stddev>0.0075</bias_stddev>
				<dynamic_bias_stddev>0.000375</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>175.0</dynamic_bias_correlation_time>
				<precision>0.005</precision>
			      </noise>
			    </x>
			    <y>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.021</stddev>
				<bias_mean>0.05</bias_mean>
				<bias_stddev>0.0075</bias_stddev>
				<dynamic_bias_stddev>0.000375</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>175.0</dynamic_bias_correlation_time>
				<precision>0.005</precision>
			      </noise>
			    </y>
			    <z>
			      <noise type="gaussian">
				<mean>0</mean>
				<stddev>0.021</stddev>
				<bias_mean>0.05</bias_mean>
				<bias_stddev>0.0075</bias_stddev>
				<dynamic_bias_stddev>0.000375</dynamic_bias_stddev>
				<dynamic_bias_correlation_time>175.0</dynamic_bias_correlation_time>
				<precision>0.005</precision>
			      </noise>
			    </z>
			  </linear_acceleration>
			</imu>
		      </sensor>
		</link>
      <joint name='lidar_joint' type='fixed'>
	<parent>hull</parent>
	<child>lidar_link</child>
      </joint>
      <joint name='imu_joint' type='fixed'>
	<parent>hull</parent>
	<child>imu_link</child>
      </joint>
      <!-- Left thruster -->
<link name="left_thruster">
  <pose>-0.7 -0.2 -0.1 0 1.57 0</pose>
  <inertial>
    <mass>0</mass>
    <inertia>
      <ixx>0.1</ixx>
      <iyy>0.1</iyy>
      <izz>0.1</izz>
    </inertia>
  </inertial>
  <visual name="left_thruster_visual">
    <geometry>
      <cylinder>
        <radius>0.05</radius>
        <length>0.1</length>
      </cylinder>
    </geometry>
    <material>
      <ambient>0.2 0.2 0.2 1</ambient>
      <diffuse>0.5 0.5 0.5 1</diffuse>
    </material>
  </visual>
</link>

<!-- Right thruster -->
<link name="right_thruster">
  <pose>-0.7 0.2 -0.1 0 1.57 0</pose>
  <inertial>
    <mass>0</mass>
    <inertia>
      <ixx>0.1</ixx>
      <iyy>0.1</iyy>
      <izz>0.1</izz>
    </inertia>
  </inertial>
  <visual name="right_thruster_visual">
    <geometry>
      <cylinder>
        <radius>0.05</radius>
        <length>0.1</length>
      </cylinder>
    </geometry>
    <material>
      <ambient>0.2 0.2 0.2 1</ambient>
      <diffuse>0.5 0.5 0.5 1</diffuse>
    </material>
  </visual>
</link>

<!-- Thruster joints -->
<joint name="left_thruster_joint" type="revolute">
  <parent>hull</parent>
  <child>left_thruster</child>
  <axis>
    <xyz>1 0 0</xyz>
  </axis>
</joint>

<joint name="right_thruster_joint" type="revolute">
  <parent>hull</parent>
  <child>right_thruster</child>
  <axis>
    <xyz>1 0 0</xyz>
  </axis>
</joint>
    <!-- Left thruster plugin -->
<plugin filename="gz-sim-thruster-system" name="gz::sim::systems::Thruster">
  <joint_name>left_thruster_joint</joint_name>
  <thrust_coefficient>0.02</thrust_coefficient>
  <fluid_density>1000</fluid_density>
  <deadband>0.0</deadband>
  <propeller_diameter>0.1</propeller_diameter>
  <topic>/model/roboboat/joint/left_thruster_joint/cmd_thrust</topic>
</plugin>

<!-- Right thruster plugin -->
<plugin filename="gz-sim-thruster-system" name="gz::sim::systems::Thruster">
  <joint_name>right_thruster_joint</joint_name>
  <thrust_coefficient>0.02</thrust_coefficient>
  <fluid_density>1000</fluid_density>
  <propeller_diameter>0.1</propeller_diameter>
  <topic>/model/roboboat/joint/right_thruster_joint/cmd_thrust</topic>
</plugin>
    </model>

    <!-- Buoy -->
    <model name='buoy_0'>
      <pose>0.14 4.2 0.25 0 0 0</pose>
      <link name='buoy_link'>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>2</ixx>
            <iyy>2</iyy>
            <izz>2</izz>
          </inertia>
        </inertial>
        <collision name='buoy_collision'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
        </collision>
        <visual name='buoy_visual'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>1 0 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
      </link>
    </model>
    
    <!-- Buoy -->
    <model name='buoy_1'>
      <pose>-1.1 -2.7 0.25 0 0 0</pose>
      <link name='buoy_link'>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>2</ixx>
            <iyy>2</iyy>
            <izz>2</izz>
          </inertia>
        </inertial>
        <collision name='buoy_collision'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
        </collision>
        <visual name='buoy_visual'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>1 0 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
      </link>
    </model>
    
    
    <!-- Buoy -->
    <model name='buoy_2'>
      <pose>1.5 -3.8 0.25 0 0 0</pose>
      <link name='buoy_link'>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>2</ixx>
            <iyy>2</iyy>
            <izz>2</izz>
          </inertia>
        </inertial>
        <collision name='buoy_collision'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
        </collision>
        <visual name='buoy_visual'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>1 1 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
      </link>
    </model>
    
    
    <!-- Buoy -->
    <model name='buoy_3'>
      <pose>-5.1 -0.7 0.25 0 0 0</pose>
      <link name='buoy_link'>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>2</ixx>
            <iyy>2</iyy>
            <izz>2</izz>
          </inertia>
        </inertial>
        <collision name='buoy_collision'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
        </collision>
        <visual name='buoy_visual'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>1 0 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
      </link>
    </model>
    
    
    <!-- Buoy -->
    <model name='buoy_4'>
      <pose>1.7 1.9 0.25 0 0 0</pose>
      <link name='buoy_link'>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>2</ixx>
            <iyy>2</iyy>
            <izz>2</izz>
          </inertia>
        </inertial>
        <collision name='buoy_collision'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
        </collision>
        <visual name='buoy_visual'>
          <geometry>
            <sphere>
              <radius>0.5</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0.3 0.3 0.3 1</ambient>
            <diffuse>1 1 0 1</diffuse>
            <specular>1 1 1 1</specular>
          </material>
        </visual>
      </link>
    </model>
    
    <!-- Sun light -->
    <light name='sun' type='directional'>
      <pose>0 0 10 0 0 0</pose>
      <cast_shadows>true</cast_shadows>
      <intensity>1</intensity>
      <direction>-0.5 0.1 -0.9</direction>
      <diffuse>0.8 0.8 0.8 1</diffuse>
      <specular>0.2 0.2 0.2 1</specular>
      <attenuation>
        <range>1000</range>
        <linear>0.01</linear>
        <constant>0.9</constant>
        <quadratic>0.001</quadratic>
      </attenuation>
    </light>
  </world>
</sdf>
